---
title: "Assignment 2"
author: "Tarun Sudhams"
date: "11/12/2018"
output: html_document
---

# Question 1 (Chapter 6, Exercise 8 (Page 262))
<br>
*In this exercise, we will generate simulated data, and will then use this data to perform best subset selection.*

*(a) Use the rnorm() function to generate a predictor X of length n = 100, as well as a noise vector eps of length n = 100.*

```{r}
set.seed(1)
x<-rnorm(100)
error<-rnorm(100)
```
<br>
*(b) Generate a response vector Y of length n = 100 according to the model Y = β0 + β1X + β2X2 + β3X3 + error, where β0, β1, β2, and β3 are constants of your choice.*

```{r}
b0 <- 2
b1 <- 3
b2 <- -1
b3 <- 0.5
y <- b0 + b1 * x + b2 * x^2 + b3 * x^3 + error
```
<br>
*(c) Use the regsubsets() function to perform best subset selection in order to choose the best model containing the predictors X,X2, . . .,X10. What is the best model obtained according to Cp, BIC, and adjusted R2? Show some plots to provide evidence for your answer, and report the coefficients of the best model obtained.Note you will need to use the data.frame() function to create a single data set containing both X and Y.*

```{r}
#Following Code Snippet shows the plots to provide evidence for my answer
library(leaps)
data.full<-data.frame(y=y,x=x)
regfit.full<-regsubsets(y~x+I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10), data = data.full, nvmax = 10, really.big = T)
reg.summary<-summary(regfit.full)
par(mfrow=c(1,3))

#Plotting Model with C_P value 
plot(reg.summary$cp,xlab="Number of Variables",ylab="C_P",type="l")
points(which.min(reg.summary$cp),reg.summary$cp[which.min(reg.summary$cp)],col="red",cex=2,pch=20)

#Plotting Model with BIC Value
plot(reg.summary$bic,xlab="Number of Variables",ylab="BIC",type="l")
points(which.min(reg.summary$bic),reg.summary$bic[which.min(reg.summary$bic)],col="red",cex=2,pch=20)

#Plotting Model with adjusted R^2 Value
plot(reg.summary$adjr,xlab="Number of Variables",ylab="Adj R^2",type="l")
points(which.max(reg.summary$adjr),reg.summary$adjr[which.max(reg.summary$adjr)],col="red",cex=2,pch=20)
```
<br>
```{r}
coef(regfit.full,which.max(reg.summary$adjr))
```

Therefore, the above three plots show that the best subset method gives us a model with 4 predictor variables when C_P, BIC and Adjusted R Square are used as the judgement criteria to select the models*
*The model so obtained selects x, X^2, X^3 and X^10 as the parameters and hence the original relationship of Y is detailed by x, x^2, x^3 and x^10 <br>
<br>
*(d) Repeat (c), using forward stepwise selection and also using backwards stepwise selection. How does your answer compare to the results in (c)?.*
<br>

First let's take a look at the Forward Selection Approach
```{r}
#Forward Selection Approach
data.full<-data.frame(y=y,x=x)
regfit.fwd<-regsubsets(y~x+I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6) + I(x^7) + I(x^8) + I(x^9) + I(x^10), data = data.full, nvmax = 10,really.big = T,method = "forward")
reg.summary.fwd<-summary(regfit.fwd)
par(mfrow=c(1,3))

#Plotting Model with C_P value 
plot(reg.summary.fwd$cp,xlab="Number of Variables",ylab="C_p",type="l")
points(which.min(reg.summary.fwd$cp),reg.summary.fwd$cp[which.min(reg.summary.fwd$cp)],col="red",cex=2,pch=20)

#Plotting Model with BIC Value
plot(reg.summary.fwd$bic,xlab="Number of Variables",ylab="BIC",type="l")
points(which.min(reg.summary.fwd$bic),reg.summary.fwd$bic[which.min(reg.summary.fwd$bic)],col="red",cex=2,pch=20)

#Plotting Model with adjusted R^2 Value
plot(reg.summary.fwd$adjr,xlab="Number of Variables",ylab="Adj R^2",type="l")
points(which.max(reg.summary.fwd$adjr),reg.summary.fwd$adjr[which.max(reg.summary.fwd$adjr2)],col="red",cex=2,pch=20)
```
<br>
```{r}
coef(regfit.fwd,which.max(reg.summary.fwd$adjr))
```
<br>

Now, let's consider the Backward Selection Approach



*(e) Now ﬁt a lasso model to the simulated data, again using X, X 2 , . . . , X 10 as predictors. Use cross-validation to select the optimal value of λ. Create plots of the cross-validation error as a function of λ. Report the resulting coeﬃcient estimates, and discuss the results obtained. *